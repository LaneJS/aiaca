<a class="skip-link" href="#settings-content">Skip to settings</a>

<section class="page-header">
  <div>
    <p class="eyebrow">Settings</p>
    <h1>Environment, roles, and safeguards</h1>
    <p class="lede">Configure operational guardrails and review key environment indicators.</p>
  </div>
  <div class="header-actions">
    <span class="pill">Env: {{ envName | titlecase }}</span>
  </div>
</section>

<section class="panel" id="settings-content">
  <header class="panel__header">
    <div>
      <p class="eyebrow">Roles</p>
      <h3>Current session</h3>
    </div>
    <span class="badge">RBAC</span>
  </header>
  <div class="table">
    <div class="table__head settings-head">
      <span>User</span>
      <span>Roles</span>
      <span>Safeguards</span>
    </div>
    <div class="table__row settings-row">
      <span class="cell-title">{{ auth.session()?.user?.email || 'Unknown user' }}</span>
      <span class="pill">{{ roles().join(', ') }}</span>
      <span class="cell-sub">Destructive actions require confirmation; viewer is read-only.</span>
    </div>
  </div>
</section>

<section class="form-grid">
  <article class="panel form-card">
    <header class="panel__header">
      <div>
        <p class="eyebrow">Email templates</p>
        <h3>Dunning/reminder copy</h3>
      </div>
      <span class="badge">Comms</span>
    </header>
    <form class="form" (ngSubmit)="saveEmailTemplate()">
      <label class="input-group">
        <span>Past-due email</span>
        <textarea rows="6" [ngModel]="emailTemplate()" (ngModelChange)="emailTemplate.set($event)" name="template"></textarea>
      </label>
      <button class="btn btn-primary" type="submit">Save template</button>
    </form>
  </article>

  <article class="panel form-card">
    <header class="panel__header">
      <div>
        <p class="eyebrow">Tax settings</p>
        <h3>Default tax rate</h3>
      </div>
      <span class="badge">Compliance</span>
    </header>
    <form class="form" (ngSubmit)="saveTaxSettings()">
      <label class="input-group">
        <span>Tax rate %</span>
        <input type="number" step="0.01" [ngModel]="taxRate()" (ngModelChange)="taxRate.set($event ? Number($event) : null)" name="taxRate" />
      </label>
      <button class="btn btn-primary" type="submit">Save tax settings</button>
    </form>
  </article>
</section>

<section class="panel">
  <header class="panel__header">
    <div>
      <p class="eyebrow">Stripe & webhooks</p>
      <h3>Health and configuration</h3>
    </div>
    <button class="btn btn-secondary" type="button" (click)="loadWebhookHealth()" [disabled]="loadingWebhook()">Check status</button>
  </header>

  <div class="table">
    <div class="table__head settings-head">
      <span>Setting</span>
      <span>Value</span>
      <span>Notes</span>
    </div>
    <div class="table__row settings-row">
      <span class="cell-title">Stripe publishable key</span>
      <span>{{ envName === 'production' ? 'Configured' : (envName | titlecase) }} {{ config.stripePublishableKey ? 'set' : 'missing' }}</span>
      <span class="cell-sub">Never expose secret key. Use Elements/Checkout for PCI boundary.</span>
    </div>
    <div class="table__row settings-row">
      <span class="cell-title">Webhook events</span>
      <span>{{ webhookStatus().failed }} failed / {{ webhookStatus().total }} total</span>
      <span class="cell-sub">Retry failures in Operations Center. Signature verification enforced.</span>
    </div>
  </div>
</section>*** End Patch
