spring.application.name=aaca-api

# Default to in-memory H2 for local development/testing; override the SPRING_DATASOURCE_* vars for Postgres.
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:h2:mem:aaca;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:sa}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}
spring.datasource.driver-class-name=${SPRING_DATASOURCE_DRIVER:org.h2.Driver}

spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:update}
spring.jpa.database-platform=${SPRING_JPA_DATABASE_PLATFORM:org.hibernate.dialect.H2Dialect}
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.show-sql=true

spring.h2.console.enabled=true

spring.flyway.enabled=${SPRING_FLYWAY_ENABLED:false}
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true

spring.sql.init.mode=never

security.jwt.secret=${SECURITY_JWT_SECRET:dev-secret-key-change-me-please-use-a-longer-random-value}
security.jwt.expiration=${SECURITY_JWT_EXPIRATION:3600000}

logging.level.org.springframework.security=INFO

management.endpoints.web.exposure.include=health,metrics,prometheus
management.endpoint.health.probes.enabled=true
management.endpoints.web.base-path=/
management.metrics.tags.application=${spring.application.name}

# Downstream services
scanner.service-url=${SCANNER_SERVICE_URL:http://scanner:4001/scan}
ai-orchestrator.service-url=${AI_ORCHESTRATOR_SERVICE_URL:http://ai-orchestrator:4002/suggest-fixes}
external.http.timeout-ms=${EXTERNAL_HTTP_TIMEOUT_MS:8000}
ai-orchestrator.use-stub=${AI_ORCHESTRATOR_USE_STUB:false}

# Billing / Stripe
# Stripe API keys
billing.stripe.secret-key=${STRIPE_SECRET_KEY:}
billing.stripe.publishable-key=${STRIPE_PUBLISHABLE_KEY:}
billing.stripe.price-id=${STRIPE_PRICE_ID:}

# Billing plan defaults
billing.plan.code=${BILLING_PLAN_CODE:starter}
billing.plan.name=${BILLING_PLAN_NAME:AACA Pro}
billing.plan.description=${BILLING_PLAN_DESCRIPTION:Full accessibility compliance monitoring}
billing.plan.amount=${BILLING_PLAN_AMOUNT:3900}
billing.plan.currency=${BILLING_PLAN_CURRENCY:USD}
billing.plan.interval=${BILLING_PLAN_INTERVAL:MONTHLY}
billing.plan.interval-count=${BILLING_PLAN_INTERVAL_COUNT:1}
billing.plan.usage-type=${BILLING_PLAN_USAGE_TYPE:LICENSED}
billing.plan.billing-scheme=${BILLING_PLAN_BILLING_SCHEME:per_unit}

# Stripe redirect URLs
billing.stripe.success-url=${STRIPE_SUCCESS_URL:http://localhost:4200/overview?checkout=success}
billing.stripe.cancel-url=${STRIPE_CANCEL_URL:http://localhost:4200/signup?checkout=canceled}
billing.stripe.return-url=${BILLING_STRIPE_RETURN_URL:http://localhost:4200/overview}

# Stripe webhook configuration
billing.stripe.webhook-secret=${STRIPE_WEBHOOK_SECRET:}
billing.stripe.tolerance-seconds=${STRIPE_WEBHOOK_TOLERANCE_SECONDS:300}
